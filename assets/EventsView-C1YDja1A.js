import{d as I,p as B,l as A,s as E,k as x,o,c as r,n as _,a as K,e as a,i as p,g as S,v as H,t as C,A as oe,B as de,C as se,q as re,b as U,w as ie,D as F,F as R,m as W,x as Y,h as z}from"./index-DeCm5EoA.js";import{M as le}from"./MainLayout-CJLtSuu1.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce=["disabled"],ue=I({__name:"AddButton",setup(f){const D=B(),k=A(),{datesDateUpdating:c,datesLoading:y}=E(D),{periodicDateUpdating:e,periodicLoading:$}=E(k),h=x(()=>y.value===!0||c.value.length!==0||$.value===!0||e.value.length!==0);return(M,b)=>(o(),r("button",{disabled:h.value,class:_({button:!0,loading:h.value})}," + ",10,ce))}}),pe=j(ue,[["__scopeId","data-v-763c1a2d"]]),ye=["disabled"],me=I({__name:"AddPeriodicButton",setup(f){const D=B(),k=A(),{datesDateUpdating:c,datesLoading:y}=E(D),{periodicDateUpdating:e,periodicLoading:$}=E(k),h=x(()=>y.value===!0||c.value.length!==0||$.value===!0||e.value.length!==0);return(M,b)=>(o(),r("button",{disabled:h.value,class:_({button:!0,loading:h.value})}," + ",10,ye))}}),ve=j(me,[["__scopeId","data-v-fcedbc1e"]]),fe={class:"modal-box"},he={key:0},ge={key:1},ke=I({__name:"EventsModal",props:["type","data"],emits:["closeModal"],setup(f,{emit:D}){var v,u,g;const k=B(),c=f,y=D,e=K({date:{day:((v=c.data)==null?void 0:v.day)||"",month:((u=c.data)==null?void 0:u.month)||"",year:c.type==="add"?new Date().getFullYear().toString():c.data.year,event:((g=c.data)==null?void 0:g.event)||""},error:!1,error_msg:""}),$=[31,28,31,30,31,30,31,31,30,31,30,31],h=(m,d,l)=>parseInt(d)>12?!1:parseInt(m)%4===0&&parseInt(d)===2&&parseInt(l)===29?!0:!(parseInt(l)>$[parseInt(d)-1]),M=m=>{let{day:d,month:l,year:O,event:V}=m;return isNaN(Number(d))||isNaN(Number(l))||isNaN(Number(O))?(e.error_msg="Niepoprawny format daty",!1):d===""||l===""||V===""?(e.error_msg="Uzupełnij wszystkie wymagane pola",!1):(d.length<2&&(d=`0${d}`),l.length<2&&(l=`0${l}`),d.length>2||l.length>2||O!==""&&O.length!==4?(e.error_msg="Niepoprawny format daty",!1):h(O,l,d)===!1?(e.error_msg="Niepoprawna data",!1):O!==""&&(O[0]!=="2"||O[1]!=="0")?(e.error_msg="Niepoprawne stulecie",!1):(e.error_msg="",!0))},b=()=>{const{data:m}=c,d=m._id;if(M(e.date)){e.error=!1;const O=e.date.event.replace(/[<>]/g,"").trim(),V={day:e.date.day.length===2?e.date.day:`0${e.date.day}`,month:e.date.month.length===2?e.date.month:`0${e.date.month}`,year:"",event:O};e.date.year!==""&&(V.year=e.date.year),k.updateDate({id:d,payload:V}),y("closeModal")}else e.error=!0},w=()=>{if(M(e.date)){e.error=!1;const d=e.date.event.replace(/[<>]/g,"").trim(),l={day:e.date.day.length===2?e.date.day:`0${e.date.day}`,month:e.date.month.length===2?e.date.month:`0${e.date.month}`,year:"",event:d};e.date.year!==""&&(l.year=e.date.year),k.postDate(l),y("closeModal")}else e.error=!0},P=()=>{const{data:m}=c,d=m._id;k.deleteDate(d),y("closeModal")},t=m=>{m.keyCode===13&&c.type==="add"&&w(),m.keyCode===13&&c.type==="edit"&&b()};return(m,d)=>(o(),r("section",fe,[a("div",{class:"modal-mask",onClick:d[0]||(d[0]=l=>m.$emit("closeModal"))}),a("section",{class:"modal-proper",onKeydown:t},[f.type==="add"?(o(),r("header",he,"Dodaj")):p("",!0),f.type==="edit"?(o(),r("header",ge,"Edytuj")):p("",!0),S(a("input",{name:"event-day","onUpdate:modelValue":d[1]||(d[1]=l=>e.date.day=l),placeholder:"DD",spellcheck:"false",autocomplete:"off"},null,512),[[H,e.date.day]]),S(a("input",{name:"event-month","onUpdate:modelValue":d[2]||(d[2]=l=>e.date.month=l),placeholder:"MM",spellcheck:"false",autocomplete:"off"},null,512),[[H,e.date.month]]),S(a("input",{name:"event-year","onUpdate:modelValue":d[3]||(d[3]=l=>e.date.year=l),placeholder:"RRRR (opcjonalne)",spellcheck:"false",autocomplete:"off"},null,512),[[H,e.date.year]]),S(a("input",{name:"event-event","onUpdate:modelValue":d[4]||(d[4]=l=>e.date.event=l),placeholder:"Wydarzenie",spellcheck:"false",autocomplete:"off"},null,512),[[H,e.date.event]]),a("p",{class:_({error:!0,open:e.error})},C(e.error_msg),3),a("footer",null,[f.type==="add"?(o(),r("button",{key:0,onClick:w},"Stwórz")):p("",!0),f.type==="edit"?(o(),r("button",{key:1,onClick:b},"Zmień")):p("",!0),a("button",{onClick:d[5]||(d[5]=l=>m.$emit("closeModal"))},"Anuluj"),f.type==="edit"?(o(),r("button",{key:2,onClick:P},"Usuń")):p("",!0)])],32)]))}}),Z=j(ke,[["__scopeId","data-v-8c8bcb17"]]),_e={class:"modal-box"},$e={key:0},Oe={key:1},Ce={class:"modal-select"},Me=I({__name:"PeriodicModal",props:["type","data"],emits:["closeModal"],setup(f,{emit:D}){var P,t;const k=A(),c=f,y=D,e=K({date:{dayNumber:parseInt((P=c.data)==null?void 0:P.dayNumber)||0,event:((t=c.data)==null?void 0:t.event)||""},error:!1,error_msg:""}),$=v=>{let{event:u}=v;return u===""?(e.error_msg="Uzupełnij wszystkie wymagane pola",!1):(e.error_msg="",!0)},h=()=>{const{data:v}=c,u=v._id;if($(e.date)){e.error=!1;const m=e.date.event.replace(/[<>]/g,"").trim(),d={dayNumber:e.date.dayNumber||"0",event:m};k.updatePeriodic({id:u,payload:d}),y("closeModal")}else e.error=!0},M=()=>{if($(e.date)){e.error=!1;const u=e.date.event.replace(/[<>]/g,"").trim(),g={dayNumber:e.date.dayNumber||"0",event:u};k.postPeriodic(g),y("closeModal")}else e.error=!0},b=()=>{const{data:v}=c,u=v._id;k.deletePeriodic(u),y("closeModal")},w=v=>{v.keyCode===13&&c.type==="add"&&M(),v.keyCode===13&&c.type==="edit"&&h()};return(v,u)=>(o(),r("section",_e,[a("div",{class:"modal-mask",onClick:u[0]||(u[0]=g=>v.$emit("closeModal"))}),a("section",{class:"modal-proper",onKeydown:w},[f.type==="add"?(o(),r("header",$e,"Dodaj")):p("",!0),f.type==="edit"?(o(),r("header",Oe,"Edytuj")):p("",!0),a("div",Ce,[S(a("select",{name:"periodic-select","onUpdate:modelValue":u[1]||(u[1]=g=>e.date.dayNumber=g)},u[4]||(u[4]=[de('<option value="0" data-v-78f7995f>Poniedziałek</option><option value="1" data-v-78f7995f>Wtorek</option><option value="2" data-v-78f7995f>Środa</option><option value="3" data-v-78f7995f>Czwartek</option><option value="4" data-v-78f7995f>Piątek</option><option value="5" data-v-78f7995f>Sobota</option><option value="6" data-v-78f7995f>Niedziela</option>',7)]),512),[[oe,e.date.dayNumber]])]),S(a("input",{name:"periodic-event","onUpdate:modelValue":u[2]||(u[2]=g=>e.date.event=g),placeholder:"Wydarzenie",spellcheck:"false",autocomplete:"off"},null,512),[[H,e.date.event]]),a("p",{class:_({error:!0,open:e.error})},C(e.error_msg),3),a("footer",null,[f.type==="add"?(o(),r("button",{key:0,onClick:M},"Stwórz")):p("",!0),f.type==="edit"?(o(),r("button",{key:1,onClick:h},"Zmień")):p("",!0),a("button",{onClick:u[3]||(u[3]=g=>v.$emit("closeModal"))},"Anuluj"),f.type==="edit"?(o(),r("button",{key:2,onClick:b},"Usuń")):p("",!0)])],32)]))}}),q=j(Me,[["__scopeId","data-v-78f7995f"]]),De={class:"date"},we={key:0,class:"date-placeholder"},be={key:1},Ne=["onClick"],ze={class:"date-format"},Pe={class:"date-event"},xe={key:0,class:"date-loader"},Ve={key:1,class:"date-mask"},Se=["onClick"],Ee={class:"date-format-name"},Ue={class:"date-event"},He={key:0,class:"date-loader"},Ie={key:1,class:"date-mask"},je={key:0,class:"date-placeholder"},Be={key:1},Ae=["onClick"],Le={class:"date-format"},Fe={class:"date-event"},Re={key:0,class:"date-loader"},We={key:1,class:"date-mask"},Ke=I({__name:"EventsView",setup(f){const D=B(),k=A(),{dates:c,datesDateUpdating:y,datesLoading:e}=E(D),{periodic:$,periodicDateUpdating:h,periodicLoading:M}=E(k),b=["Poniedziałek","Wtorek","Środa","Czwartek","Piątek","Sobota","Niedziela"],w=x(()=>e.value===!0||y.value.length!==0||M.value===!0||h.value.length!==0),P=x(()=>e.value===!0&&y.value.length===0||M.value===!0&&h.value.length===0),t=K({addModalOpen:!1,editModalOpen:!1,addPeriodicOpen:!1,editPeriodicOpen:!1,editedData:{},editedPeriodic:{},yearlyOpen:!1,yearlyOpenHeight:0,periodicOpen:!1,periodicOpenHeight:0,eventsOpen:!0,eventsOpenHeight:0}),v=x(()=>$.value.length!==0?$.value.sort(l):[]),u=x(()=>c.value.length!==0?c.value.filter(N=>!N.year).sort(m):[]),g=x(()=>c.value.length!==0?c.value.filter(N=>N.year).sort(d):[]),m=(i,n)=>`${i.month}${i.day}`>`${n.month}${n.day}`?1:`${n.month}${n.day}`>`${i.month}${i.day}`?-1:0,d=(i,n)=>`${i.year}${i.month}${i.day}`>`${n.year}${n.month}${n.day}`?1:`${n.year}${n.month}${n.day}`>`${i.year}${i.month}${i.day}`?-1:0,l=(i,n)=>`${i.dayNumber}`>`${n.dayNumber}`?1:`${n.dayNumber}`>`${i.dayNumber}`?-1:0,O=()=>{t.addModalOpen=!0},V=()=>{t.addModalOpen=!1},T=i=>{t.editedData=i,t.editModalOpen=!0},G=()=>{t.editModalOpen=!1},Q=()=>{t.addPeriodicOpen=!0},X=()=>{t.addPeriodicOpen=!1},ee=i=>{t.editedPeriodic=i,t.editPeriodicOpen=!0},te=()=>{t.editPeriodicOpen=!1},L=(i,n)=>{switch(n){case"yearlyOpen":{t.yearlyOpen=!t.yearlyOpen;break}case"periodicOpen":{t.periodicOpen=!t.periodicOpen;break}case"eventsOpen":{t.eventsOpen=!t.eventsOpen;break}}},ae=i=>{const n=new Date;return new Date(i.year,i.month-1,i.day,23,59,59)<n},J=()=>{const n=document.getElementById("eventsDrawer").children[0].clientHeight;t.eventsOpenHeight=n;const N=document.getElementById("yearlyDrawer").children[0].clientHeight;t.yearlyOpenHeight=N;const ne=document.getElementById("periodicDrawer").children[0].clientHeight;t.periodicOpenHeight=ne};return se(w,()=>{J()}),re(()=>J()),(i,n)=>(o(),U(le,null,{default:ie(()=>[a("section",De,[t.addModalOpen?(o(),U(Z,{key:0,type:"add",onCloseModal:V})):p("",!0),t.editModalOpen?(o(),U(Z,{key:1,type:"edit",data:t.editedData,onCloseModal:G},null,8,["data"])):p("",!0),t.addPeriodicOpen?(o(),U(q,{key:2,type:"add",onCloseModal:X})):p("",!0),t.editPeriodicOpen?(o(),U(q,{key:3,type:"edit",data:t.editedPeriodic,onCloseModal:te},null,8,["data"])):p("",!0),a("section",{class:_({"date-header":!0,"date-header-first":!0,open:t.yearlyOpen}),onClick:n[0]||(n[0]=s=>L(s,"yearlyOpen"))},n[3]||(n[3]=[a("p",null,"Coroczne",-1)]),2),a("div",{id:"yearlyDrawer",class:_({"date-items_container":!0,closed:!t.yearlyOpen}),style:F({"max-height":`${t.yearlyOpenHeight+20}px`})},[u.value.length===0?(o(),r("p",we," Jeszcze nic tu nie ma. Dodaj nową datę używając przycisku na dole ekranu. ")):p("",!0),u.value.length!==0?(o(),r("section",be,[(o(!0),r(R,null,W(u.value,s=>(o(),r("div",{key:s.id,class:_({"date-container":!0,loading:z(y).indexOf(s._id)!==-1}),onClick:N=>T(s)},[a("p",ze,C(s.day)+"."+C(s.month),1),a("p",Pe,C(s.event),1),z(e)===!0&&z(y).length===0||z(y).indexOf(s._id)!==-1?(o(),r("div",xe)):p("",!0),w.value?(o(),r("div",Ve)):p("",!0)],10,Ne))),128))])):p("",!0)],6),a("section",{class:_({"date-header":!0,open:t.periodicOpen}),onClick:n[1]||(n[1]=s=>L(s,"periodicOpen"))},n[4]||(n[4]=[a("p",null,"Cotygodniowe",-1)]),2),a("div",{id:"periodicDrawer",class:_({"date-items_container":!0,closed:!t.periodicOpen}),style:F({"max-height":`${t.periodicOpenHeight+20}px`})},[a("section",null,[a("section",null,[a("section",{onClick:Q},[Y(ve)]),(o(!0),r(R,null,W(v.value,s=>(o(),r("div",{key:s.id,class:_({"date-container":!0,loading:z(h).indexOf(s._id)!==-1}),onClick:N=>ee(s)},[a("p",Ee,C(b[s.dayNumber]),1),a("p",Ue,C(s.event),1),P.value||z(h).indexOf(s._id)!==-1?(o(),r("div",He)):p("",!0),w.value?(o(),r("div",Ie)):p("",!0)],10,Se))),128))])])],6),a("section",{class:_({"date-header":!0,open:t.eventsOpen}),onClick:n[2]||(n[2]=s=>L(s,"eventsOpen"))},n[5]||(n[5]=[a("p",null,"Nadchodzące wydarzenia",-1)]),2),a("div",{id:"eventsDrawer",class:_({"date-items_container":!0,closed:!t.eventsOpen}),style:F({"max-height":`${t.eventsOpenHeight+20}px`})},[g.value.length===0?(o(),r("p",je," Jeszcze nic tu nie ma. Dodaj nową datę używając przycisku na dole ekranu. ")):p("",!0),g.value.length!==0?(o(),r("section",Be,[(o(!0),r(R,null,W(g.value,s=>(o(),r("div",{key:s.id,class:_({"date-container":!0,grey:ae(s)===!0,loading:z(y).indexOf(s._id)!==-1}),onClick:N=>T(s)},[a("p",Le,C(s.day)+"."+C(s.month)+"."+C(s.year),1),a("p",Fe,C(s.event),1),P.value||z(y).indexOf(s._id)!==-1?(o(),r("div",Re)):p("",!0),w.value?(o(),r("div",We)):p("",!0)],10,Ae))),128))])):p("",!0)],6),a("section",{onClick:O},[Y(pe)])])]),_:1}))}}),qe=j(Ke,[["__scopeId","data-v-eae2b4d5"]]);export{qe as default};
